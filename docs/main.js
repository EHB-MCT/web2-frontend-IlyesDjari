(()=>{var e="http://127.0.0.1:5500/web2-frontend-IlyesDjari/docs/pages/home.html",t="75d6012515364a608ebbf7ec5113308c",n="e9069eeeb800474394cbe578f1a93c67",o=null,s=null;function l(){let e="grant_type=refresh_token";e+="&refresh_token="+(s=localStorage.getItem("refresh_token")),e+="&client_id="+t,a(e)}function a(e){let o=new XMLHttpRequest;o.open("POST","https://accounts.spotify.com/api/token",!0),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.setRequestHeader("Authorization","Basic "+btoa(t+":"+n)),o.send(e),o.onload=i}function i(){if(200==this.status){var e=JSON.parse(this.responseText);console.log(e),null!=e.access_token&&(o=e.access_token,localStorage.setItem("access_token",o)),null!=e.refresh_token&&(s=e.refresh_token,localStorage.setItem("refresh_token",s)),onPageLoad()}else console.log(this.responseText),alert(this.responseText)}function r(e,t,n,s){let l=new XMLHttpRequest;l.open(e,t,!0),l.setRequestHeader("Content-Type","application/json"),l.setRequestHeader("Authorization","Bearer "+o),l.send(n),l.onload=s}function c(){var e=JSON.parse(this.responseText);const t=(new Date).getHours();null!=e?(document.getElementById("username").innerHTML=e.display_name,document.getElementById("userpicture").src=e.images[0].url,document.getElementById("daytime").innerHTML=t<12?"Good morning, ":t<18?"Good afternoon, ":"Good evening, "):401==this.status&&l()}function u(){var e=JSON.parse(this.responseText);console.log(e),200==this.status?null!=e.item&&(document.getElementById("imgcurrent").src=e.item.album.images[0].url,document.getElementById("artistcurrent").innerHTML=e.item.artists[0].name,document.getElementById("songcurrent").innerHTML=e.item.name):401==this.status&&l()}function d(){var e=JSON.parse(this.responseText);if(console.log(e),null!=e.albums)for(let t=0;t<5;t++)document.getElementById("release").insertAdjacentHTML("afterbegin",`\n            <a href="${e.albums.items[t].external_urls.spotify}"">\n            <div>\n            <img src="${e.albums.items[t].images[0].url}" alt="cover">\n            <h3>${e.albums.items[t].artists[0].name}</h3>\n            <p>${e.albums.items[t].name}</p>\n            </div>\n            </a>`);else 401==this.status&&l()}document.documentElement.addEventListener("load",(function(){document.getElementById("loader").style.display="block"})),window.addEventListener("load",(function(){document.getElementById("loader").style.display="none"})),window.onload=function(){t=localStorage.getItem("client_id"),n=localStorage.getItem("client_secret"),window.location.search.length>0?(function(o){let s="grant_type=authorization_code";s+="&code="+o,s+="&redirect_uri="+encodeURI(e),s+="&client_id="+t,s+="&client_secret="+n,a(s)}(function(){let e=null;const t=window.location.search;return t.length>0&&(e=new URLSearchParams(t).get("code")),e}()),window.history.pushState("","",e)):null==(o=localStorage.getItem("access_token"))?document.getElementById("tokenSection").style.display="block":(r("GET","https://api.spotify.com/v1/me",null,c),r("GET","https://api.spotify.com/v1/me/player",null,u),r("GET",`https://api.spotify.com/v1/browse/new-releases?country=BE&limit=5&offset=${Math.floor(20*Math.random())}`,null,d))},document.getElementById("loginbutton").addEventListener("click",(function(){console.log("hello")}))})();